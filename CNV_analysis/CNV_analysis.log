Warning message:
In checkDepPackageVersion(dep_pkg = "TMB") :
  Package version inconsistency detected.
glmmTMB was built with TMB version 1.8.0
Current TMB version is 1.8.1
Please re-install glmmTMB from source or restore original ‘TMB’ package (see '?reinstalling' for more information)
null device 
          1 
null device 
          1 
null device 
          1 
null device 
          1 
null device 
          1 
null device 
          1 

	#######################
	# Copy number testing #
	#######################

	Modal copy number test for Avrankou_Delta:

Analysing genes with CNV at >= 10% freq (Cyp6aa1, Cyp6aa2, Gste1, Gste2, Gste3, Gste4, Gste5, Gste7).

Using the following string to control for confounding factors: 

Detecting invariable and nearly invariable markers.

Analysing markers independently.

Running commentary on model optimisation:

Building model: glm(phenotype ~ 1 , data = test.table, family = binomial) 
	No further markers are significant, keeping final model:

Call:  glm(formula = phenotype ~ 1, family = binomial, data = test.table)

Coefficients:
(Intercept)  
    -0.5108  

Degrees of Freedom: 71 Total (i.e. Null);  71 Residual
Null Deviance:	    95.27 
Residual Deviance: 95.27 	AIC: 97.27
Final model was the null model.


   P deviance
1 NA       NA
$invariable.markers
character(0)

$correlated.markers
character(0)

$sig.alone
                P pseudo.R2
Cyp6aa1 0.0749981        NA
Cyp6aa2 0.1037580        NA
Gste1   0.4569638        NA
Gste2   0.5136484        NA
Gste3   0.5930319        NA
Gste4   0.7089592        NA
Gste5   0.7089592        NA
Gste7   0.5930319        NA

$final.model

Call:  glm(formula = phenotype ~ 1, family = binomial, data = test.table)

Coefficients:
(Intercept)  
    -0.5108  

Degrees of Freedom: 71 Total (i.e. Null);  71 Residual
Null Deviance:	    95.27 
Residual Deviance: 95.27 	AIC: 97.27

$final.sig
   P deviance
1 NA       NA


	Modal copy number test for Baguida_Delta:

Analysing genes with CNV at >= 10% freq (Ace1, Cyp9k1).

Using the following string to control for confounding factors: 

Detecting invariable and nearly invariable markers.

Analysing markers independently.

Running commentary on model optimisation:

Building model: glm(phenotype ~ 1 , data = test.table, family = binomial) 
	No further markers are significant, keeping final model:

Call:  glm(formula = phenotype ~ 1, family = binomial, data = test.table)

Coefficients:
(Intercept)  
    -0.5232  

Degrees of Freedom: 85 Total (i.e. Null);  85 Residual
Null Deviance:	    113.5 
Residual Deviance: 113.5 	AIC: 115.5
Final model was the null model.


   P deviance
1 NA       NA
$invariable.markers
character(0)

$correlated.markers
character(0)

$sig.alone
               P pseudo.R2
Ace1   0.3953833        NA
Cyp9k1 0.7607804        NA

$final.model

Call:  glm(formula = phenotype ~ 1, family = binomial, data = test.table)

Coefficients:
(Intercept)  
    -0.5232  

Degrees of Freedom: 85 Total (i.e. Null);  85 Residual
Null Deviance:	    113.5 
Residual Deviance: 113.5 	AIC: 115.5

$final.sig
   P deviance
1 NA       NA


	Modal copy number test for Korle-Bu_Delta:

Analysing genes with CNV at >= 10% freq (Ace1, Cyp6aa1, Cyp6aa2, Cyp6p3, Cyp9k1, Gste1, Gste2, Gste3, Gste7).

Using the following string to control for confounding factors: 

Detecting invariable and nearly invariable markers.

Analysing markers independently.

Running commentary on model optimisation:

Building model: glm(phenotype ~ 1 , data = test.table, family = binomial) 
	Adding marker Cyp6aa1 as the lowest significant marker (P = 0.01414258).

Building model: glm(phenotype ~ Cyp6aa1, data = test.table, family = binomial) 
	Could not calculate p-value for marker Cyp6aa2.

	No further markers are significant, keeping final model:

Call:  glm(formula = phenotype ~ Cyp6aa1, family = binomial, data = test.table)

Coefficients:
(Intercept)      Cyp6aa1  
     0.7127      -0.9345  

Degrees of Freedom: 117 Total (i.e. Null);  116 Residual
Null Deviance:	    157.8 
Residual Deviance: 151.8 	AIC: 155.8
Final model contained 1 parameters: Cyp6aa1.


                 P deviance
Cyp6aa1 0.01414258 6.020258
$invariable.markers
character(0)

$correlated.markers
character(0)

$sig.alone
                 P pseudo.R2
Ace1    0.53502553        NA
Cyp6aa1 0.01414258        NA
Cyp6aa2 0.01414258        NA
Cyp6p3  0.40097185        NA
Cyp9k1  0.22103459        NA
Gste1   0.27330774        NA
Gste2   0.27330774        NA
Gste3   0.27330774        NA
Gste7   0.27330774        NA

$final.model

Call:  glm(formula = phenotype ~ Cyp6aa1, family = binomial, data = test.table)

Coefficients:
(Intercept)      Cyp6aa1  
     0.7127      -0.9345  

Degrees of Freedom: 117 Total (i.e. Null);  116 Residual
Null Deviance:	    157.8 
Residual Deviance: 151.8 	AIC: 155.8

$final.sig
                 P deviance
Cyp6aa1 0.01414258 6.020258


	Modal copy number test for Madina_Delta:

Analysing genes with CNV at >= 10% freq (Ace1, Cyp6p3, Cyp6p4, Cyp6p5, Cyp6z1, Cyp6z2, Cyp6z3, Cyp9k1).

Using the following string to control for confounding factors: 

Detecting invariable and nearly invariable markers.

Analysing markers independently.

Running commentary on model optimisation:

Building model: glm(phenotype ~ 1 , data = test.table, family = binomial) 
	No further markers are significant, keeping final model:

Call:  glm(formula = phenotype ~ 1, family = binomial, data = test.table)

Coefficients:
(Intercept)  
    -0.5447  

Degrees of Freedom: 78 Total (i.e. Null);  78 Residual
Null Deviance:	    103.9 
Residual Deviance: 103.9 	AIC: 105.9
Final model was the null model.


   P deviance
1 NA       NA
$invariable.markers
character(0)

$correlated.markers
character(0)

$sig.alone
               P pseudo.R2
Ace1   0.3405702        NA
Cyp6p3 0.8607712        NA
Cyp6p4 0.6128296        NA
Cyp6p5 0.9433984        NA
Cyp6z1 0.4757610        NA
Cyp6z2 0.6956175        NA
Cyp6z3 0.2507815        NA
Cyp9k1 0.2663047        NA

$final.model

Call:  glm(formula = phenotype ~ 1, family = binomial, data = test.table)

Coefficients:
(Intercept)  
    -0.5447  

Degrees of Freedom: 78 Total (i.e. Null);  78 Residual
Null Deviance:	    103.9 
Residual Deviance: 103.9 	AIC: 105.9

$final.sig
   P deviance
1 NA       NA


	Modal copy number test for Obuasi_Delta:

Analysing genes with CNV at >= 10% freq (Ace1, Cyp6z1, Cyp6z2, Cyp6z3, Cyp9k1).

Using the following string to control for confounding factors: 

Detecting invariable and nearly invariable markers.

Analysing markers independently.

Running commentary on model optimisation:

Building model: glm(phenotype ~ 1 , data = test.table, family = binomial) 
	No further markers are significant, keeping final model:

Call:  glm(formula = phenotype ~ 1, family = binomial, data = test.table)

Coefficients:
(Intercept)  
     0.4884  

Degrees of Freedom: 70 Total (i.e. Null);  70 Residual
Null Deviance:	    94.32 
Residual Deviance: 94.32 	AIC: 96.32
Final model was the null model.


   P deviance
1 NA       NA
$invariable.markers
character(0)

$correlated.markers
character(0)

$sig.alone
               P pseudo.R2
Ace1   0.9776156        NA
Cyp6z1 0.6737610        NA
Cyp6z2 0.7807122        NA
Cyp6z3 0.6737610        NA
Cyp9k1 0.8812562        NA

$final.model

Call:  glm(formula = phenotype ~ 1, family = binomial, data = test.table)

Coefficients:
(Intercept)  
     0.4884  

Degrees of Freedom: 70 Total (i.e. Null);  70 Residual
Null Deviance:	    94.32 
Residual Deviance: 94.32 	AIC: 96.32

$final.sig
   P deviance
1 NA       NA


	Modal copy number test for Baguida_PM:

Analysing genes with CNV at >= 10% freq (Ace1, Cyp9k1).

Using the following string to control for confounding factors: 

Detecting invariable and nearly invariable markers.

Analysing markers independently.

Running commentary on model optimisation:

Building model: glm(phenotype ~ 1 , data = test.table, family = binomial) 
	No further markers are significant, keeping final model:

Call:  glm(formula = phenotype ~ 1, family = binomial, data = test.table)

Coefficients:
(Intercept)  
    -0.2683  

Degrees of Freedom: 59 Total (i.e. Null);  59 Residual
Null Deviance:	    82.11 
Residual Deviance: 82.11 	AIC: 84.11
Final model was the null model.


   P deviance
1 NA       NA
$invariable.markers
character(0)

$correlated.markers
character(0)

$sig.alone
               P pseudo.R2
Ace1   0.8218438        NA
Cyp9k1 0.3300181        NA

$final.model

Call:  glm(formula = phenotype ~ 1, family = binomial, data = test.table)

Coefficients:
(Intercept)  
    -0.2683  

Degrees of Freedom: 59 Total (i.e. Null);  59 Residual
Null Deviance:	    82.11 
Residual Deviance: 82.11 	AIC: 84.11

$final.sig
   P deviance
1 NA       NA


	Modal copy number test for Korle-Bu_PM:

Analysing genes with CNV at >= 10% freq (Ace1, Cyp6aa1, Cyp6aa2, Cyp6p3, Cyp9k1, Gste1, Gste2, Gste3, Gste7).

Using the following string to control for confounding factors: 

Detecting invariable and nearly invariable markers.

Analysing markers independently.

Running commentary on model optimisation:

Building model: glm(phenotype ~ 1 , data = test.table, family = binomial) 
	Adding marker Ace1 as the lowest significant marker (P = 6.148141e-10).

Building model: glm(phenotype ~ Ace1, data = test.table, family = binomial) 
	No further markers are significant, keeping final model:

Call:  glm(formula = phenotype ~ Ace1, family = binomial, data = test.table)

Coefficients:
(Intercept)         Ace1  
      2.423       -1.254  

Degrees of Freedom: 81 Total (i.e. Null);  80 Residual
Null Deviance:	    112.5 
Residual Deviance: 74.18 	AIC: 78.18
Final model contained 1 parameters: Ace1.


                P deviance
Ace1 6.148141e-10 38.27384
$invariable.markers
character(0)

$correlated.markers
character(0)

$sig.alone
                   P pseudo.R2
Ace1    6.148141e-10        NA
Cyp6aa1 2.166542e-01        NA
Cyp6aa2 4.068033e-01        NA
Cyp6p3  9.404487e-01        NA
Cyp9k1  4.629916e-01        NA
Gste1   2.881826e-01        NA
Gste2   2.881826e-01        NA
Gste3   2.881826e-01        NA
Gste7   2.881826e-01        NA

$final.model

Call:  glm(formula = phenotype ~ Ace1, family = binomial, data = test.table)

Coefficients:
(Intercept)         Ace1  
      2.423       -1.254  

Degrees of Freedom: 81 Total (i.e. Null);  80 Residual
Null Deviance:	    112.5 
Residual Deviance: 74.18 	AIC: 78.18

$final.sig
                P deviance
Ace1 6.148141e-10 38.27384


	Modal copy number test for Madina_PM:

Analysing genes with CNV at >= 10% freq (Ace1, Cyp6p3, Cyp6p4, Cyp6p5, Cyp6z2, Cyp9k1).

Using the following string to control for confounding factors: 

Detecting invariable and nearly invariable markers.

Analysing markers independently.

Running commentary on model optimisation:

Building model: glm(phenotype ~ 1 , data = test.table, family = binomial) 
	Adding marker Ace1 as the lowest significant marker (P = 8.18523e-07).

Building model: glm(phenotype ~ Ace1, data = test.table, family = binomial) 
	No further markers are significant, keeping final model:

Call:  glm(formula = phenotype ~ Ace1, family = binomial, data = test.table)

Coefficients:
(Intercept)         Ace1  
      3.013       -1.372  

Degrees of Freedom: 40 Total (i.e. Null);  39 Residual
Null Deviance:	    56.62 
Residual Deviance: 32.3 	AIC: 36.3
Final model contained 1 parameters: Ace1.


               P deviance
Ace1 8.18523e-07 24.31376
$invariable.markers
character(0)

$correlated.markers
character(0)

$sig.alone
                  P pseudo.R2
Ace1   8.185230e-07        NA
Cyp6p3 8.459457e-01        NA
Cyp6p4 1.912790e-01        NA
Cyp6p5 8.293456e-01        NA
Cyp6z2 5.775627e-01        NA
Cyp9k1 6.783316e-01        NA

$final.model

Call:  glm(formula = phenotype ~ Ace1, family = binomial, data = test.table)

Coefficients:
(Intercept)         Ace1  
      3.013       -1.372  

Degrees of Freedom: 40 Total (i.e. Null);  39 Residual
Null Deviance:	    56.62 
Residual Deviance: 32.3 	AIC: 36.3

$final.sig
               P deviance
Ace1 8.18523e-07 24.31376


	Modal copy number test for Obuasi_PM:

Analysing genes with CNV at >= 10% freq (Ace1, Cyp9k1).

Using the following string to control for confounding factors: 

Detecting invariable and nearly invariable markers.

Analysing markers independently.

Running commentary on model optimisation:

Building model: glm(phenotype ~ 1 , data = test.table, family = binomial) 
	Adding marker Ace1 as the lowest significant marker (P = 3.682177e-06).

Building model: glm(phenotype ~ Ace1, data = test.table, family = binomial) 
	No further markers are significant, keeping final model:

Call:  glm(formula = phenotype ~ Ace1, family = binomial, data = test.table)

Coefficients:
(Intercept)         Ace1  
      3.835       -0.882  

Degrees of Freedom: 88 Total (i.e. Null);  87 Residual
Null Deviance:	    120.1 
Residual Deviance: 98.69 	AIC: 102.7
Final model contained 1 parameters: Ace1.


                P deviance
Ace1 3.682177e-06 21.42356
$invariable.markers
character(0)

$correlated.markers
character(0)

$sig.alone
                  P pseudo.R2
Ace1   3.682177e-06        NA
Cyp9k1 7.669854e-01        NA

$final.model

Call:  glm(formula = phenotype ~ Ace1, family = binomial, data = test.table)

Coefficients:
(Intercept)         Ace1  
      3.835       -0.882  

Degrees of Freedom: 88 Total (i.e. Null);  87 Residual
Null Deviance:	    120.1 
Residual Deviance: 98.69 	AIC: 102.7

$final.sig
                P deviance
Ace1 3.682177e-06 21.42356



All populations PM:
Using the following string to control for confounding factors:  + (1|location)

Detecting invariable and nearly invariable markers.

Analysing markers independently.

Running commentary on model optimisation:

Building model: glmmTMB(phenotype ~ 1  + (1|location), data = pm.table, family = binomial) 
	Adding marker Ace1 as the lowest significant marker (P = 2.425391e-12).

Building model: glmmTMB(phenotype ~ Ace1 + (1|location), data = pm.table, family = binomial) 
	No further markers are significant, keeping final model:
Formula:          phenotype ~ Ace1 + (1 | location)
Data: pm.table
      AIC       BIC    logLik  df.resid 
 328.6402  339.4576 -161.3201       269 
Random-effects (co)variances:

Conditional model:
 Groups   Name        Std.Dev.
 location (Intercept) 0.9241  

Number of obs: 272 / Conditional model: location, 4

Fixed Effects:

Conditional model:
(Intercept)         Ace1  
     2.4226      -0.7341  
Final model contained 1 parameters: Ace1.


                P deviance
Ace1 2.425391e-12       NA
$invariable.markers
character(0)

$correlated.markers
character(0)

$sig.alone
                  P pseudo.R2
Ace1   2.425391e-12        NA
Cyp9k1 6.466513e-01        NA

$final.model
Formula:          phenotype ~ Ace1 + (1 | location)
Data: pm.table
      AIC       BIC    logLik  df.resid 
 328.6402  339.4576 -161.3201       269 
Random-effects (co)variances:

Conditional model:
 Groups   Name        Std.Dev.
 location (Intercept) 0.9241  

Number of obs: 272 / Conditional model: location, 4

Fixed Effects:

Conditional model:
(Intercept)         Ace1  
     2.4226      -0.7341  

$final.sig
                P deviance
Ace1 2.425391e-12       NA



All populations Delta:
Using the following string to control for confounding factors:  + (1|location)

Detecting invariable and nearly invariable markers.

Analysing markers independently.

Running commentary on model optimisation:

Building model: glmmTMB(phenotype ~ 1  + (1|location), data = delta.table, family = binomial) 
	No further markers are significant, keeping final model:
Formula:          phenotype ~ 1 + (1 | location)
Data: delta.table
      AIC       BIC    logLik  df.resid 
 581.6078  589.7166 -288.8039       424 
Random-effects (co)variances:

Conditional model:
 Groups   Name        Std.Dev.
 location (Intercept) 0.4384  

Number of obs: 426 / Conditional model: location, 5

Fixed Effects:

Conditional model:
(Intercept)  
     -0.123  
Final model was the null model.


   P deviance
1 NA       NA
$invariable.markers
character(0)

$correlated.markers
character(0)

$sig.alone
               P pseudo.R2
Ace1   0.9577268        NA
Cyp9k1 0.5433029        NA

$final.model
Formula:          phenotype ~ 1 + (1 | location)
Data: delta.table
      AIC       BIC    logLik  df.resid 
 581.6078  589.7166 -288.8039       424 
Random-effects (co)variances:

Conditional model:
 Groups   Name        Std.Dev.
 location (Intercept) 0.4384  

Number of obs: 426 / Conditional model: location, 5

Fixed Effects:

Conditional model:
(Intercept)  
     -0.123  

$final.sig
   P deviance
1 NA       NA



Ace1 combined + Del1 presence, PM, location as fixed factor:
Single term deletions

Model:
phenotype ~ Ace1 + Ace1_Del1_presence + (1 | location)
                   Df    AIC     LRT  Pr(>Chi)    
<none>                327.83                      
Ace1                1 351.29 25.4664 4.501e-07 ***
Ace1_Del1_presence  1 328.64  2.8133   0.09349 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

	 Coefficients (negative means positively association with resistance:
Formula:          phenotype ~ Ace1 + Ace1_Del1_presence + (1 | location)
Data: modal.copy.number[insecticide == "PM"]
      AIC       BIC    logLik  df.resid 
 327.8269  342.2501 -159.9134       268 
Random-effects (co)variances:

Conditional model:
 Groups   Name        Std.Dev.
 location (Intercept) 0.9527  

Number of obs: 272 / Conditional model: location, 4

Fixed Effects:

Conditional model:
           (Intercept)                    Ace1  Ace1_Del1_presenceTRUE  
                2.6489                 -0.6311                 -0.7853  


Ace1 combined + Del1 copy number, PM, location as fixed factor:
Single term deletions

Model:
phenotype ~ Ace1 + Ace1_Del_cn + (1 | location)
            Df    AIC    LRT  Pr(>Chi)    
<none>         330.61                     
Ace1         1 359.73 31.122 2.423e-08 ***
Ace1_Del_cn  1 328.64  0.031    0.8603    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

	##############################
	# Cyp6aap Dup allele testing #
	##############################


Cyp6aap alleles in Avrankou:
Using the following string to control for confounding factors: 

Detecting invariable and nearly invariable markers.

Analysing markers independently.

Running commentary on model optimisation:

Building model: glm(phenotype ~ 1 , data = avrankou.delta.allele.table, family = binomial) 
	No further markers are significant, keeping final model:

Call:  glm(formula = phenotype ~ 1, family = binomial, data = avrankou.delta.allele.table)

Coefficients:
(Intercept)  
    -0.2803  

Degrees of Freedom: 78 Total (i.e. Null);  78 Residual
  (11 observations deleted due to missingness)
Null Deviance:	    108 
Residual Deviance: 108 	AIC: 110
Final model was the null model.


   P deviance
1 NA       NA
$invariable.markers
character(0)

$correlated.markers
character(0)

$sig.alone
                      P pseudo.R2
Cyp6aap_Dup7  0.7371700        NA
Cyp6aap_Dup10 0.4528001        NA

$final.model

Call:  glm(formula = phenotype ~ 1, family = binomial, data = avrankou.delta.allele.table)

Coefficients:
(Intercept)  
    -0.2803  

Degrees of Freedom: 78 Total (i.e. Null);  78 Residual
  (11 observations deleted due to missingness)
Null Deviance:	    108 
Residual Deviance: 108 	AIC: 110

$final.sig
   P deviance
1 NA       NA

Using the following string to control for confounding factors: 

Detecting invariable and nearly invariable markers.

Analysing markers independently.

Running commentary on model optimisation:

Building model: glm(phenotype ~ 1 , data = korlebu.delta.allele.table, family = binomial) 
	Adding marker Cyp6aap_Dup10 as the lowest significant marker (P = 0.005342071).

Building model: glm(phenotype ~ Cyp6aap_Dup10, data = korlebu.delta.allele.table, family = binomial) 
	No further markers are significant, keeping final model:

Call:  glm(formula = phenotype ~ Cyp6aap_Dup10, family = binomial, data = korlebu.delta.allele.table)

Coefficients:
      (Intercept)  Cyp6aap_Dup10TRUE  
           0.4555            -2.4014  

Degrees of Freedom: 141 Total (i.e. Null);  140 Residual
  (8 observations deleted due to missingness)
Null Deviance:	    192.8 
Residual Deviance: 185 	AIC: 189
Final model contained 1 parameters: Cyp6aap_Dup10.


                        P deviance
Cyp6aap_Dup10 0.005342071 7.759839
$invariable.markers
character(0)

$correlated.markers
character(0)

$sig.alone
                        P pseudo.R2
Cyp6aap_Dup10 0.005342071        NA
Cyp6aap_Dup17 0.767717058        NA
Cyp6aap_Dup18 0.073036892        NA

$final.model

Call:  glm(formula = phenotype ~ Cyp6aap_Dup10, family = binomial, data = korlebu.delta.allele.table)

Coefficients:
      (Intercept)  Cyp6aap_Dup10TRUE  
           0.4555            -2.4014  

Degrees of Freedom: 141 Total (i.e. Null);  140 Residual
  (8 observations deleted due to missingness)
Null Deviance:	    192.8 
Residual Deviance: 185 	AIC: 189

$final.sig
                        P deviance
Cyp6aap_Dup10 0.005342071 7.759839

